{"ast":null,"code":"import Handler from './Handler';\nimport { domFind } from './util/dom';\nimport { HrefEvent, TooltipShowEvent, TooltipHideEvent } from './util/events';\nimport { inherits } from 'vega-util';\nexport default function SVGHandler(loader, tooltip) {\n  Handler.call(this, loader, tooltip);\n  var h = this;\n  h._hrefHandler = listener(h, function (evt, item) {\n    if (item && item.href) h.handleHref(evt, item, item.href);\n  });\n  h._tooltipHandler = listener(h, function (evt, item) {\n    h.handleTooltip(evt, item, evt.type !== TooltipHideEvent);\n  });\n}\nvar prototype = inherits(SVGHandler, Handler);\n\nprototype.initialize = function (el, origin, obj) {\n  var svg = this._svg;\n\n  if (svg) {\n    svg.removeEventListener(HrefEvent, this._hrefHandler);\n    svg.removeEventListener(TooltipShowEvent, this._tooltipHandler);\n    svg.removeEventListener(TooltipHideEvent, this._tooltipHandler);\n  }\n\n  this._svg = svg = el && domFind(el, 'svg');\n\n  if (svg) {\n    svg.addEventListener(HrefEvent, this._hrefHandler);\n    svg.addEventListener(TooltipShowEvent, this._tooltipHandler);\n    svg.addEventListener(TooltipHideEvent, this._tooltipHandler);\n  }\n\n  return Handler.prototype.initialize.call(this, el, origin, obj);\n};\n\nprototype.canvas = function () {\n  return this._svg;\n}; // wrap an event listener for the SVG DOM\n\n\nfunction listener(context, handler) {\n  return function (evt) {\n    var target = evt.target,\n        item = target.__data__;\n    evt.vegaType = evt.type;\n    item = Array.isArray(item) ? item[0] : item;\n    handler.call(context._obj, evt, item);\n  };\n} // add an event handler\n\n\nprototype.on = function (type, handler) {\n  var name = this.eventName(type),\n      h = this._handlers,\n      i = this._handlerIndex(h[name], type, handler);\n\n  if (i < 0) {\n    var x = {\n      type: type,\n      handler: handler,\n      listener: listener(this, handler)\n    };\n    (h[name] || (h[name] = [])).push(x);\n\n    if (this._svg) {\n      this._svg.addEventListener(name, x.listener);\n    }\n  }\n\n  return this;\n}; // remove an event handler\n\n\nprototype.off = function (type, handler) {\n  var name = this.eventName(type),\n      h = this._handlers[name],\n      i = this._handlerIndex(h, type, handler);\n\n  if (i >= 0) {\n    if (this._svg) {\n      this._svg.removeEventListener(name, h[i].listener);\n    }\n\n    h.splice(i, 1);\n  }\n\n  return this;\n};","map":null,"metadata":{},"sourceType":"module"}