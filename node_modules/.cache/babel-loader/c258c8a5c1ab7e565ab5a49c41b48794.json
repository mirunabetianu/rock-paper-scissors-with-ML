{"ast":null,"code":"import { eventExpression, handlerExpression } from './expression';\nimport parseParameters from './parameters';\nimport { error, isObject } from 'vega-util';\n/**\n * Parse an event-driven operator update.\n */\n\nexport default function (spec, ctx) {\n  var srcid = isObject(srcid = spec.source) ? srcid.$ref : srcid,\n      source = ctx.get(srcid),\n      target = null,\n      update = spec.update,\n      params = undefined;\n  if (!source) error('Source not defined: ' + spec.source);\n\n  if (spec.target && spec.target.$expr) {\n    target = eventExpression(spec.target.$expr, ctx);\n  } else {\n    target = ctx.get(spec.target);\n  }\n\n  if (update && update.$expr) {\n    if (update.$params) {\n      params = parseParameters(update.$params, ctx);\n    }\n\n    update = handlerExpression(update.$expr, ctx);\n  }\n\n  ctx.update(spec, source, target, update, params);\n}","map":null,"metadata":{},"sourceType":"module"}