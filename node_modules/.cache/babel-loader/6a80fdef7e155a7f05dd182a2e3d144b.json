{"ast":null,"code":"import { Transform, ingest, replace } from 'vega-dataflow';\nimport { inherits, isFunction } from 'vega-util';\nimport { geoGraticule } from 'd3-geo';\n/**\n * GeoJSON feature generator for creating graticules.\n * @constructor\n */\n\nexport default function Graticule(params) {\n  Transform.call(this, [], params);\n  this.generator = geoGraticule();\n}\nGraticule.Definition = {\n  \"type\": \"Graticule\",\n  \"metadata\": {\n    \"changes\": true,\n    \"generates\": true\n  },\n  \"params\": [{\n    \"name\": \"extent\",\n    \"type\": \"array\",\n    \"array\": true,\n    \"length\": 2,\n    \"content\": {\n      \"type\": \"number\",\n      \"array\": true,\n      \"length\": 2\n    }\n  }, {\n    \"name\": \"extentMajor\",\n    \"type\": \"array\",\n    \"array\": true,\n    \"length\": 2,\n    \"content\": {\n      \"type\": \"number\",\n      \"array\": true,\n      \"length\": 2\n    }\n  }, {\n    \"name\": \"extentMinor\",\n    \"type\": \"array\",\n    \"array\": true,\n    \"length\": 2,\n    \"content\": {\n      \"type\": \"number\",\n      \"array\": true,\n      \"length\": 2\n    }\n  }, {\n    \"name\": \"step\",\n    \"type\": \"number\",\n    \"array\": true,\n    \"length\": 2\n  }, {\n    \"name\": \"stepMajor\",\n    \"type\": \"number\",\n    \"array\": true,\n    \"length\": 2,\n    \"default\": [90, 360]\n  }, {\n    \"name\": \"stepMinor\",\n    \"type\": \"number\",\n    \"array\": true,\n    \"length\": 2,\n    \"default\": [10, 10]\n  }, {\n    \"name\": \"precision\",\n    \"type\": \"number\",\n    \"default\": 2.5\n  }]\n};\nvar prototype = inherits(Graticule, Transform);\n\nprototype.transform = function (_, pulse) {\n  var src = this.value,\n      gen = this.generator,\n      t;\n\n  if (!src.length || _.modified()) {\n    for (var prop in _) {\n      if (isFunction(gen[prop])) {\n        gen[prop](_[prop]);\n      }\n    }\n  }\n\n  t = gen();\n\n  if (src.length) {\n    pulse.mod.push(replace(src[0], t));\n  } else {\n    pulse.add.push(ingest(t));\n  }\n\n  src[0] = t;\n  return pulse;\n};","map":null,"metadata":{},"sourceType":"module"}