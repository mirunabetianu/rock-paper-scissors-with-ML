{"ast":null,"code":"import { merge } from 'vega-util';\nexport default function (idFunc, source, input) {\n  var $ = idFunc,\n      _data = source || [],\n      _add = input || [],\n      rem = {},\n      cnt = 0;\n\n  return {\n    add: function add(t) {\n      _add.push(t);\n    },\n    remove: function remove(t) {\n      rem[$(t)] = ++cnt;\n    },\n    size: function size() {\n      return _data.length;\n    },\n    data: function data(compare, resort) {\n      if (cnt) {\n        _data = _data.filter(function (t) {\n          return !rem[$(t)];\n        });\n        rem = {};\n        cnt = 0;\n      }\n\n      if (resort && compare) {\n        _data.sort(compare);\n      }\n\n      if (_add.length) {\n        _data = compare ? merge(compare, _data, _add.sort(compare)) : _data.concat(_add);\n        _add = [];\n      }\n\n      return _data;\n    }\n  };\n}","map":null,"metadata":{},"sourceType":"module"}