{"ast":null,"code":"import { random } from './random';\nexport default function (dists, weights) {\n  var dist = {},\n      m = 0,\n      w;\n\n  function normalize(x) {\n    var w = [],\n        sum = 0,\n        i;\n\n    for (i = 0; i < m; ++i) {\n      sum += w[i] = x[i] == null ? 1 : +x[i];\n    }\n\n    for (i = 0; i < m; ++i) {\n      w[i] /= sum;\n    }\n\n    return w;\n  }\n\n  dist.weights = function (_) {\n    if (arguments.length) {\n      w = normalize(weights = _ || []);\n      return dist;\n    }\n\n    return weights;\n  };\n\n  dist.distributions = function (_) {\n    if (arguments.length) {\n      if (_) {\n        m = _.length;\n        dists = _;\n      } else {\n        m = 0;\n        dists = [];\n      }\n\n      return dist.weights(weights);\n    }\n\n    return dists;\n  };\n\n  dist.sample = function () {\n    var r = random(),\n        d = dists[m - 1],\n        v = w[0],\n        i = 0; // first select distribution\n\n    for (; i < m - 1; v += w[++i]) {\n      if (r < v) {\n        d = dists[i];\n        break;\n      }\n    } // then sample from it\n\n\n    return d.sample();\n  };\n\n  dist.pdf = function (x) {\n    for (var p = 0, i = 0; i < m; ++i) {\n      p += w[i] * dists[i].pdf(x);\n    }\n\n    return p;\n  };\n\n  dist.cdf = function (x) {\n    for (var p = 0, i = 0; i < m; ++i) {\n      p += w[i] * dists[i].cdf(x);\n    }\n\n    return p;\n  };\n\n  dist.icdf = function () {\n    throw Error('Mixture icdf not supported.');\n  };\n\n  return dist.distributions(dists).weights(weights);\n}","map":null,"metadata":{},"sourceType":"module"}